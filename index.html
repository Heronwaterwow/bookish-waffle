<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WalletConnect v2 Integration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .connect-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            text-align: center;
        }
        
        .wallet-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        
        .wallet-info.active {
            display: block;
        }
        
        button {
            background: #3b99fc;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .qr-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            text-align: center;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .transaction-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .implementation-guide {
            margin-top: 40px;
            padding: 20px;
            background: #fff;
            border-left: 4px solid #3b99fc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ”— WalletConnect v2.0 Integration</h1>
            <p>Official implementation guide for secure wallet connectivity</p>
        </div>

        <div class="connect-section">
            <h3>Wallet Connection</h3>
            <button id="connectBtn">Connect Wallet</button>
            <button id="disconnectBtn" disabled>Disconnect</button>
            
            <div id="qrContainer" class="qr-container" style="display: none;">
                <div id="qrCode"></div>
            </div>
            
            <div id="status" class="status" style="display: none;"></div>
        </div>

        <div id="walletInfo" class="wallet-info">
            <h4>Connected Wallet Information</h4>
            <p><strong>Address:</strong> <span id="walletAddress"></span></p>
            <p><strong>Chain:</strong> <span id="chainId"></span></p>
            <p><strong>Session Topic:</strong> <span id="sessionTopic"></span></p>
        </div>

        <div class="transaction-section">
            <h3>Transaction Testing</h3>
            <button id="signMessageBtn" disabled>Sign Message</button>
            <button id="sendTransactionBtn" disabled>Send Test Transaction</button>
            <div id="transactionResult" style="margin-top: 15px;"></div>
        </div>

        <div class="implementation-guide">
            <h2>ðŸ“š Implementation Guide</h2>
            
            <h3>1. Installation</h3>
            <div class="code-block">
npm install @walletconnect/sign-client @walletconnect/qrcode-modal
# or
yarn add @walletconnect/sign-client @walletconnect/qrcode-modal
            </div>

            <h3>2. Basic Setup</h3>
            <div class="code-block">
import { SignClient } from '@walletconnect/sign-client'
import QRCodeModal from '@walletconnect/qrcode-modal'

// Initialize WalletConnect client
const signClient = await SignClient.init({
  projectId: 'YOUR_PROJECT_ID', // Get from WalletConnect Cloud
  metadata: {
    name: 'Your dApp Name',
    description: 'Your dApp Description',
    url: 'https://yourdapp.com',
    icons: ['https://yourdapp.com/icon.png']
  }
})
            </div>

            <h3>3. Connection Flow</h3>
            <div class="code-block">
// Create connection proposal
const { uri, approval } = await signClient.connect({
  requiredNamespaces: {
    eip155: {
      methods: ['eth_sendTransaction', 'personal_sign'],
      chains: ['eip155:1'], // Ethereum mainnet
      events: ['accountsChanged', 'chainChanged']
    }
  }
})

// Show QR code to user
if (uri) {
  QRCodeModal.open(uri, () => {
    console.log('QR Code Modal closed')
  })
}

// Wait for wallet approval
const session = await approval()
QRCodeModal.close()
            </div>

            <h3>4. Sending Requests</h3>
            <div class="code-block">
// Sign a message
const result = await signClient.request({
  topic: session.topic,
  chainId: 'eip155:1',
  request: {
    method: 'personal_sign',
    params: ['Hello WalletConnect!', account]
  }
})

// Send transaction
const txResult = await signClient.request({
  topic: session.topic,
  chainId: 'eip155:1',
  request: {
    method: 'eth_sendTransaction',
    params: [{
      from: account,
      to: '0x...',
      value: '0x...',
      gasLimit: '0x5208',
      gasPrice: '0x...'
    }]
  }
})
            </div>

            <h3>5. Event Handling</h3>
            <div class="code-block">
// Listen for session events
signClient.on('session_event', ({ event, chainId }) => {
  console.log('Session event:', event, chainId)
})

// Listen for session updates
signClient.on('session_update', ({ topic, params }) => {
  console.log('Session updated:', topic, params)
})

// Listen for session deletion
signClient.on('session_delete', ({ topic }) => {
  console.log('Session deleted:', topic)
})
            </div>

            <h3>6. Security Best Practices</h3>
            <ul>
                <li><strong>Project ID:</strong> Always use your own Project ID from WalletConnect Cloud</li>
                <li><strong>Metadata:</strong> Provide accurate dApp metadata for user trust</li>
                <li><strong>Namespace Validation:</strong> Only request necessary methods and chains</li>
                <li><strong>Session Management:</strong> Properly handle session lifecycle</li>
                <li><strong>Error Handling:</strong> Implement comprehensive error handling</li>
                <li><strong>User Consent:</strong> Always show clear transaction details to users</li>
            </ul>

            <h3>7. Supported Chains</h3>
            <div class="code-block">
// Ethereum
eip155:1 (Mainnet)
eip155:5 (Goerli)
eip155:137 (Polygon)

// Solana
solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp (Mainnet)
solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1 (Devnet)

// Cosmos
cosmos:cosmoshub-4 (Cosmos Hub)

// Near
near:mainnet
near:testnet
            </div>

            <h3>8. Error Handling</h3>
            <div class="code-block">
try {
  const session = await approval()
  // Handle successful connection
} catch (error) {
  if (error.message.includes('User rejected')) {
    // User rejected the connection
  } else if (error.message.includes('timeout')) {
    // Connection timeout
  } else {
    // Other errors
    console.error('Connection error:', error)
  }
}
            </div>
        </div>
    </div>

    <!-- WalletConnect SDK (for demonstration - in production use npm packages) -->
    <script>
        // This is a simplified demonstration
        // In production, use the actual WalletConnect SDK via npm/yarn
        
        class WalletConnectDemo {
            constructor() {
                this.isConnected = false;
                this.session = null;
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.getElementById('connectBtn').addEventListener('click', () => this.connect());
                document.getElementById('disconnectBtn').addEventListener('click', () => this.disconnect());
                document.getElementById('signMessageBtn').addEventListener('click', () => this.signMessage());
                document.getElementById('sendTransactionBtn').addEventListener('click', () => this.sendTransaction());
            }

            showStatus(message, type = 'info') {
                const status = document.getElementById('status');
                status.textContent = message;
                status.className = `status ${type}`;
                status.style.display = 'block';
            }

            async connect() {
                this.showStatus('Initializing WalletConnect...', 'info');
                
                // Simulate connection process
                setTimeout(() => {
                    this.showStatus('Generating QR Code...', 'info');
                    document.getElementById('qrContainer').style.display = 'block';
                    document.getElementById('qrCode').innerHTML = `
                        <div style="width: 200px; height: 200px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; border: 2px dashed #ccc;">
                            <p style="text-align: center; color: #666;">QR Code<br/>Scan with wallet app</p>
                        </div>
                    `;
                }, 1000);

                // Simulate successful connection
                setTimeout(() => {
                    this.isConnected = true;
                    this.session = {
                        topic: 'demo-topic-' + Math.random().toString(36).substr(2, 9),
                        accounts: ['0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6'],
                        chainId: 'eip155:1'
                    };

                    document.getElementById('qrContainer').style.display = 'none';
                    this.showStatus('Wallet connected successfully!', 'success');
                    this.updateUI();
                }, 3000);
            }

            disconnect() {
                this.isConnected = false;
                this.session = null;
                this.showStatus('Wallet disconnected', 'info');
                this.updateUI();
            }

            updateUI() {
                const connectBtn = document.getElementById('connectBtn');
                const disconnectBtn = document.getElementById('disconnectBtn');
                const signMessageBtn = document.getElementById('signMessageBtn');
                const sendTransactionBtn = document.getElementById('sendTransactionBtn');
                const walletInfo = document.getElementById('walletInfo');

                if (this.isConnected) {
                    connectBtn.disabled = true;
                    disconnectBtn.disabled = false;
                    signMessageBtn.disabled = false;
                    sendTransactionBtn.disabled = false;
                    walletInfo.classList.add('active');

                    document.getElementById('walletAddress').textContent = this.session.accounts[0];
                    document.getElementById('chainId').textContent = this.session.chainId;
                    document.getElementById('sessionTopic').textContent = this.session.topic;
                } else {
                    connectBtn.disabled = false;
                    disconnectBtn.disabled = true;
                    signMessageBtn.disabled = true;
                    sendTransactionBtn.disabled = true;
                    walletInfo.classList.remove('active');
                }
            }

            async signMessage() {
                if (!this.isConnected) return;

                this.showStatus('Requesting message signature...', 'info');
                
                // Simulate signing process
                setTimeout(() => {
                    const signature = '0x' + Math.random().toString(16).substr(2, 64);
                    document.getElementById('transactionResult').innerHTML = `
                        <div class="status success">
                            <strong>Message Signed!</strong><br/>
                            Signature: ${signature}
                        </div>
                    `;
                }, 2000);
            }

            async sendTransaction() {
                if (!this.isConnected) return;

                this.showStatus('Requesting transaction...', 'info');
                
                // Simulate transaction process
                setTimeout(() => {
                    const txHash = '0x' + Math.random().toString(16).substr(2, 64);
                    document.getElementById('transactionResult').innerHTML = `
                        <div class="status success">
                            <strong>Transaction Sent!</strong><br/>
                            Hash: ${txHash}
                        </div>
                    `;
                }, 3000);
            }
        }

        // Initialize demo when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new WalletConnectDemo();
        });
    </script>
</body>
</html>
